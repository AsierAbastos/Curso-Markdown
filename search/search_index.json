{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Reto 2: Detecci\u00f3n con Suricata, TCPDump y TCPReplay Sistema de detecci\u00f3n de intrusos (IDS) Un IDS (Sistema de Detecci\u00f3n de Intrusiones, por sus siglas en ingl\u00e9s) es un tipo de software o hardware dise\u00f1ado para monitorear y analizar el tr\u00e1fico de red o los eventos en un sistema inform\u00e1tico en busca de actividades maliciosas o comportamientos sospechosos. El objetivo principal de un IDS es detectar intrusiones o intentos de violar la seguridad de un sistema. Hay dos tipos principales de IDS: * IDS de Red (NIDS): Examina el tr\u00e1fico en la red y busca patrones o firmas conocidas de ataques. Puede operar en modo promiscuo, donde analiza todo el tr\u00e1fico que pasa a trav\u00e9s de una red, o en modo de enlace, donde se enfoca en analizar el tr\u00e1fico destinado a una interfaz de red espec\u00edfica. * IDS de Host (HIDS): Se instala en sistemas individuales y monitorea la actividad en esos sistemas en busca de comportamientos an\u00f3malos o actividades sospechosas. Puede analizar registros del sistema, cambios en archivos, o cualquier actividad que pueda indicar una intrusi\u00f3n. Cuando un IDS detecta un comportamiento sospechoso o una posible intrusi\u00f3n, puede generar alertas, registrar la actividad o tomar medidas para bloquear o prevenir la acci\u00f3n maliciosa. Es importante destacar que un IDS no evita por s\u00ed mismo intrusiones, sino que act\u00faa como un sistema de alerta temprana para que los administradores de seguridad puedan tomar medidas correctivas. Suricata IDS Suricata es un Sistema de Detecci\u00f3n de Intrusiones basado en Red (NIDS) y Sistema de Prevenci\u00f3n de Intrusiones basado en Red (NIPS) de c\u00f3digo abierto. Fue desarrollado para proporcionar una soluci\u00f3n de seguridad de red avanzada capaz de detectar y prevenir actividades maliciosas en entornos de red. Suricata se basa en la tecnolog\u00eda de procesamiento de informaci\u00f3n de alto rendimiento y es conocido por su capacidad para analizar el tr\u00e1fico de red a alta velocidad, no impactando sobre la calidad del servicio. Algunas caracter\u00edsticas clave de Suricata son: 1. Motor de Detecci\u00f3n Multi-Hilo: Suricata utiliza un motor de detecci\u00f3n multi-hilo que permite un an\u00e1lisis de tr\u00e1fico m\u00e1s eficiente y r\u00e1pido, usando varios n\u00facleos del procesador. Puede manejar grandes vol\u00famenes de datos de red en tiempo real. 2. Soporte para Reglas de Firma y Reglas de Comportamiento: Al igual que otros IDS/IPS (Como Snort), Suricata utiliza reglas para identificar patrones asociados con amenazas conocidas. 3. Soporte para muchos protocolos: Suricata es capaz de analizar y detectar amenazas en una variedad de protocolos de red, como TCP, UDP, ICMP, HTTP, DNS, entre otros. 4. Modo de Prevenci\u00f3n (IPS): Adem\u00e1s de la detecci\u00f3n de intrusiones, Suricata puede operar en modo de prevenci\u00f3n para bloquear activamente el tr\u00e1fico que se identifica como malicioso seg\u00fan las reglas configuradas. 5. Registro Detallado y Salida JSON: Suricata proporciona registros detallados de eventos (LOGs) y admite la salida de registros en formato JSON, lo que facilita la integraci\u00f3n con sistemas de gesti\u00f3n de eventos e informaci\u00f3n de seguridad (SIEM). Suricata es una opci\u00f3n popular para aquellos que buscan una soluci\u00f3n de detecci\u00f3n y prevenci\u00f3n de intrusiones eficiente y de c\u00f3digo abierto. Se utiliza en diversos entornos, desde redes empresariales hasta sistemas de seguridad para servidores web. Adem\u00e1s de su funci\u00f3n principal como IDS/IPS, Suricata tambi\u00e9n puede ser utilizado como un potente sensor de red para la monitorizaci\u00f3n de la actividad de la red. TCPDump y TCPReplay TCPDump es una herramienta de l\u00ednea de comandos en sistemas operativos basados en Unix y Linux que permite capturar y analizar el tr\u00e1fico de red en tiempo real. Con TCPDump, puedes interceptar y mostrar los paquetes que viajan a trav\u00e9s de una interfaz de red espec\u00edfica. Esta herramienta es \u00fatil para el an\u00e1lisis de redes, resoluci\u00f3n de problemas, y monitoreo del tr\u00e1fico. Al ejecutar TCPDump, puedes especificar filtros para capturar paquetes espec\u00edficos bas\u00e1ndote en direcciones IP, puertos, protocolos, entre otros criterios. Esto facilita la observaci\u00f3n y el an\u00e1lisis del tr\u00e1fico de red en un nivel m\u00e1s detallado. La informaci\u00f3n capturada por TCPDump puede ser guardada en archivos para su posterior an\u00e1lisis o revisi\u00f3n. TCPReplay es una herramienta de software que permite reproducir tr\u00e1fico de red previamente grabado. Es \u00fatil en situaciones donde se desea emular o replicar patrones espec\u00edficos de tr\u00e1fico en una red para prop\u00f3sitos de prueba, an\u00e1lisis o depuraci\u00f3n. Pruebas de rendimiento: Puedes reproducir grabaciones de tr\u00e1fico real en una red para evaluar el rendimiento de sistemas de red, como firewalls, IDS (Sistemas de Detecci\u00f3n de Intrusos), y otros dispositivos de seguridad. Desarrollo y depuraci\u00f3n: Los desarrolladores pueden utilizar TCPReplay para reproducir tr\u00e1fico de red y simular situaciones espec\u00edficas con el fin de depurar y probar sus aplicaciones. Entrenamiento y simulaci\u00f3n: En entornos de capacitaci\u00f3n, TCPReplay se puede utilizar para simular escenarios de red espec\u00edficos, permitiendo a los profesionales de seguridad y redes practicar y mejorar sus habilidades. El funcionamiento b\u00e1sico de TCPReplay implica tomar un archivo de captura de tr\u00e1fico (por ejemplo, creado con TCPDump), y reproducir ese tr\u00e1fico a trav\u00e9s de una interfaz de red. Puedes ajustar la velocidad de reproducci\u00f3n y otras opciones seg\u00fan tus necesidades. Capturando y replicando tr\u00e1fico En la presente sesi\u00f3n, capturaremos tr\u00e1fico para analizarlo en suricata. Para obtener tr\u00e1fico malicioso, vamos a generar tr\u00e1fico proveniente de una auditor\u00eda a una m\u00e1quina. Dado que lo hemos realizado en la UD anterior, vamos a replicar 3 acciones expuestas por el profesor sobre Metasploitable: * La fase de escaner con NMAP * La fase de explotaci\u00f3n al CVE-2007-6750 (DOS con Slowloris) * La fase de explotaci\u00f3n al CVE-2011-2523 (Shell mediante el exploit en sftpd) Encontramos TCPDump instalado en Metasploitable por defecto. Para lanzarlo se usa la siguiente orden: tcpdump -i eth0 -w nombre.pcap #sustituyendo eth0 por tu interfaz Una vez est\u00e1 funcionando la captura, realizamos las pruebas. Ser\u00e1 adecuado (para reducir el volumen de tr\u00e1fico) dejar preparada la prueba, lanzar TCPDump, iniciar la prueba y pararla inmediatamente despu\u00e9s de acabar esta. Acto seguido, debemos preparar la m\u00e1quina Ubuntu con Suricata. Configuramos el IDS (suricata.yaml) con las IPs que tuvi\u00e9ramos en el laboratorio. Para replicar el tr\u00e1fico, con suricata corriendo, escribimos: tcpreplay -i eth0 #sustituyendo eth0 por tu interfaz Existen multitud de opciones en estas dos herramientas como, por ejemplo, la reproducci\u00f3n r\u00e1pida con TCPReplay (ahorrando tiempo). Para descubrirlas, tenemos disponible el manual o la documentaci\u00f3n en internet. Entrega Sube a Aules un documento PDF con las alertas encontradas y una interpretaci\u00f3n de estas, as\u00ed como de la regla que las ha hecho saltar.","title":"Reto 2: Detecci\u00f3n con Suricata, TCPDump y TCPReplay"},{"location":"#reto-2-deteccion-con-suricata-tcpdump-y-tcpreplay","text":"","title":"Reto 2: Detecci\u00f3n con Suricata, TCPDump y TCPReplay"},{"location":"#sistema-de-deteccion-de-intrusos-ids","text":"Un IDS (Sistema de Detecci\u00f3n de Intrusiones, por sus siglas en ingl\u00e9s) es un tipo de software o hardware dise\u00f1ado para monitorear y analizar el tr\u00e1fico de red o los eventos en un sistema inform\u00e1tico en busca de actividades maliciosas o comportamientos sospechosos. El objetivo principal de un IDS es detectar intrusiones o intentos de violar la seguridad de un sistema. Hay dos tipos principales de IDS: * IDS de Red (NIDS): Examina el tr\u00e1fico en la red y busca patrones o firmas conocidas de ataques. Puede operar en modo promiscuo, donde analiza todo el tr\u00e1fico que pasa a trav\u00e9s de una red, o en modo de enlace, donde se enfoca en analizar el tr\u00e1fico destinado a una interfaz de red espec\u00edfica. * IDS de Host (HIDS): Se instala en sistemas individuales y monitorea la actividad en esos sistemas en busca de comportamientos an\u00f3malos o actividades sospechosas. Puede analizar registros del sistema, cambios en archivos, o cualquier actividad que pueda indicar una intrusi\u00f3n. Cuando un IDS detecta un comportamiento sospechoso o una posible intrusi\u00f3n, puede generar alertas, registrar la actividad o tomar medidas para bloquear o prevenir la acci\u00f3n maliciosa. Es importante destacar que un IDS no evita por s\u00ed mismo intrusiones, sino que act\u00faa como un sistema de alerta temprana para que los administradores de seguridad puedan tomar medidas correctivas.","title":"Sistema de detecci\u00f3n de intrusos (IDS)"},{"location":"#suricata-ids","text":"Suricata es un Sistema de Detecci\u00f3n de Intrusiones basado en Red (NIDS) y Sistema de Prevenci\u00f3n de Intrusiones basado en Red (NIPS) de c\u00f3digo abierto. Fue desarrollado para proporcionar una soluci\u00f3n de seguridad de red avanzada capaz de detectar y prevenir actividades maliciosas en entornos de red. Suricata se basa en la tecnolog\u00eda de procesamiento de informaci\u00f3n de alto rendimiento y es conocido por su capacidad para analizar el tr\u00e1fico de red a alta velocidad, no impactando sobre la calidad del servicio. Algunas caracter\u00edsticas clave de Suricata son: 1. Motor de Detecci\u00f3n Multi-Hilo: Suricata utiliza un motor de detecci\u00f3n multi-hilo que permite un an\u00e1lisis de tr\u00e1fico m\u00e1s eficiente y r\u00e1pido, usando varios n\u00facleos del procesador. Puede manejar grandes vol\u00famenes de datos de red en tiempo real. 2. Soporte para Reglas de Firma y Reglas de Comportamiento: Al igual que otros IDS/IPS (Como Snort), Suricata utiliza reglas para identificar patrones asociados con amenazas conocidas. 3. Soporte para muchos protocolos: Suricata es capaz de analizar y detectar amenazas en una variedad de protocolos de red, como TCP, UDP, ICMP, HTTP, DNS, entre otros. 4. Modo de Prevenci\u00f3n (IPS): Adem\u00e1s de la detecci\u00f3n de intrusiones, Suricata puede operar en modo de prevenci\u00f3n para bloquear activamente el tr\u00e1fico que se identifica como malicioso seg\u00fan las reglas configuradas. 5. Registro Detallado y Salida JSON: Suricata proporciona registros detallados de eventos (LOGs) y admite la salida de registros en formato JSON, lo que facilita la integraci\u00f3n con sistemas de gesti\u00f3n de eventos e informaci\u00f3n de seguridad (SIEM). Suricata es una opci\u00f3n popular para aquellos que buscan una soluci\u00f3n de detecci\u00f3n y prevenci\u00f3n de intrusiones eficiente y de c\u00f3digo abierto. Se utiliza en diversos entornos, desde redes empresariales hasta sistemas de seguridad para servidores web. Adem\u00e1s de su funci\u00f3n principal como IDS/IPS, Suricata tambi\u00e9n puede ser utilizado como un potente sensor de red para la monitorizaci\u00f3n de la actividad de la red.","title":"Suricata IDS"},{"location":"#tcpdump-y-tcpreplay","text":"TCPDump es una herramienta de l\u00ednea de comandos en sistemas operativos basados en Unix y Linux que permite capturar y analizar el tr\u00e1fico de red en tiempo real. Con TCPDump, puedes interceptar y mostrar los paquetes que viajan a trav\u00e9s de una interfaz de red espec\u00edfica. Esta herramienta es \u00fatil para el an\u00e1lisis de redes, resoluci\u00f3n de problemas, y monitoreo del tr\u00e1fico. Al ejecutar TCPDump, puedes especificar filtros para capturar paquetes espec\u00edficos bas\u00e1ndote en direcciones IP, puertos, protocolos, entre otros criterios. Esto facilita la observaci\u00f3n y el an\u00e1lisis del tr\u00e1fico de red en un nivel m\u00e1s detallado. La informaci\u00f3n capturada por TCPDump puede ser guardada en archivos para su posterior an\u00e1lisis o revisi\u00f3n. TCPReplay es una herramienta de software que permite reproducir tr\u00e1fico de red previamente grabado. Es \u00fatil en situaciones donde se desea emular o replicar patrones espec\u00edficos de tr\u00e1fico en una red para prop\u00f3sitos de prueba, an\u00e1lisis o depuraci\u00f3n. Pruebas de rendimiento: Puedes reproducir grabaciones de tr\u00e1fico real en una red para evaluar el rendimiento de sistemas de red, como firewalls, IDS (Sistemas de Detecci\u00f3n de Intrusos), y otros dispositivos de seguridad. Desarrollo y depuraci\u00f3n: Los desarrolladores pueden utilizar TCPReplay para reproducir tr\u00e1fico de red y simular situaciones espec\u00edficas con el fin de depurar y probar sus aplicaciones. Entrenamiento y simulaci\u00f3n: En entornos de capacitaci\u00f3n, TCPReplay se puede utilizar para simular escenarios de red espec\u00edficos, permitiendo a los profesionales de seguridad y redes practicar y mejorar sus habilidades. El funcionamiento b\u00e1sico de TCPReplay implica tomar un archivo de captura de tr\u00e1fico (por ejemplo, creado con TCPDump), y reproducir ese tr\u00e1fico a trav\u00e9s de una interfaz de red. Puedes ajustar la velocidad de reproducci\u00f3n y otras opciones seg\u00fan tus necesidades.","title":"TCPDump y TCPReplay"},{"location":"#capturando-y-replicando-trafico","text":"En la presente sesi\u00f3n, capturaremos tr\u00e1fico para analizarlo en suricata. Para obtener tr\u00e1fico malicioso, vamos a generar tr\u00e1fico proveniente de una auditor\u00eda a una m\u00e1quina. Dado que lo hemos realizado en la UD anterior, vamos a replicar 3 acciones expuestas por el profesor sobre Metasploitable: * La fase de escaner con NMAP * La fase de explotaci\u00f3n al CVE-2007-6750 (DOS con Slowloris) * La fase de explotaci\u00f3n al CVE-2011-2523 (Shell mediante el exploit en sftpd) Encontramos TCPDump instalado en Metasploitable por defecto. Para lanzarlo se usa la siguiente orden: tcpdump -i eth0 -w nombre.pcap #sustituyendo eth0 por tu interfaz Una vez est\u00e1 funcionando la captura, realizamos las pruebas. Ser\u00e1 adecuado (para reducir el volumen de tr\u00e1fico) dejar preparada la prueba, lanzar TCPDump, iniciar la prueba y pararla inmediatamente despu\u00e9s de acabar esta. Acto seguido, debemos preparar la m\u00e1quina Ubuntu con Suricata. Configuramos el IDS (suricata.yaml) con las IPs que tuvi\u00e9ramos en el laboratorio. Para replicar el tr\u00e1fico, con suricata corriendo, escribimos: tcpreplay -i eth0 #sustituyendo eth0 por tu interfaz Existen multitud de opciones en estas dos herramientas como, por ejemplo, la reproducci\u00f3n r\u00e1pida con TCPReplay (ahorrando tiempo). Para descubrirlas, tenemos disponible el manual o la documentaci\u00f3n en internet.","title":"Capturando y replicando tr\u00e1fico"},{"location":"#entrega","text":"Sube a Aules un documento PDF con las alertas encontradas y una interpretaci\u00f3n de estas, as\u00ed como de la regla que las ha hecho saltar.","title":"Entrega"}]}